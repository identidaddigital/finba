function cf7msm_uniqueArray(e,s){for(var f={},t=[],c=2;c--;e=s)e.map(function(e){f[e]=f[e]||t.push(e)});return t}function cf7msm_hasSS(){var e="test";try{return sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(e){return!1}}function quoteattr(e,s){return s=s?"&#13;":"\n",(""+e).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,s).replace(/[\r\n]/g,s)}function escapeattr(e){return(""+e).replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\u00A0/g,"\\u00A0").replace(/&/g,"\\x26").replace(/'/g,"\\x27").replace(/"/g,"\\x22").replace(/</g,"\\x3C").replace(/>/g,"\\x3E")}var cf7msm_ss;jQuery(document).ready(function($){function e(e){var s=["_wpcf7cf_hidden_group_fields","_wpcf7cf_hidden_groups","_wpcf7cf_visible_groups"],f=$(e),t=f.find("input[name='_wpcf7cf_hidden_group_fields']"),c=f.find("input[name='_wpcf7cf_hidden_groups']"),n=f.find("input[name='_wpcf7cf_visible_groups']"),r=JSON.parse(t.val()),m=JSON.parse(c.val()),i=JSON.parse(n.val()),a=m.concat(i),p=[];f.find("*[name]:not([data-cf7msm-previous])").each(function(e){p.push(this.name)});var _=[],o=[],u=[];cf7msm_ss=sessionStorage.getObject("cf7msm"),cf7msm_ss||(cf7msm_ss={}),cf7msm_ss.hasOwnProperty("_wpcf7cf_hidden_group_fields")&&(_=JSON.parse(cf7msm_ss._wpcf7cf_hidden_group_fields)),cf7msm_ss.hasOwnProperty("_wpcf7cf_hidden_groups")&&(o=JSON.parse(cf7msm_ss._wpcf7cf_hidden_groups)),cf7msm_ss.hasOwnProperty("_wpcf7cf_visible_groups")&&(u=JSON.parse(cf7msm_ss._wpcf7cf_visible_groups));var l=[],d=[],g=[];jQuery.grep(_,function(e){-1==jQuery.inArray(e,p)&&d.push(e)}),jQuery.grep(o,function(e){-1==jQuery.inArray(e,a)&&l.push(e)}),jQuery.grep(u,function(e){-1==jQuery.inArray(e,a)&&g.push(e)}),cf7msm_ss._wpcf7cf_hidden_group_fields=JSON.stringify(d.concat(r)),cf7msm_ss._wpcf7cf_hidden_groups=JSON.stringify(l.concat(m)),cf7msm_ss._wpcf7cf_visible_groups=JSON.stringify(g.concat(i)),sessionStorage.setObject("cf7msm",cf7msm_ss),t.val(cf7msm_ss._wpcf7cf_hidden_group_fields),c.val(cf7msm_ss._wpcf7cf_hidden_groups),n.val(cf7msm_ss._wpcf7cf_visible_groups)}var s=cf7msm_posted_data,f=$("input[name='cf7msm-step']");if(0!=f.length){if(cf7msm_hasSS()){if(null!=(cf7msm_ss=sessionStorage.getObject("cf7msm"))&&f.length>0){var t=$(f[0].form);$.each(cf7msm_ss,function(e,s){"cf7msm_prev_urls"==e&&t.find(".wpcf7-back, .wpcf7-previous").click(function(e){window.location.href=s[f.val()],e.preventDefault()})})}s=cf7msm_ss}else $("input[name='cf7msm-no-ss']").val(1),$(".wpcf7-previous").hide();var c=f.val().split("-"),n=parseInt(c[0]);if(s){var t=$(f[0].form);$.each(s,function(e,s){if(e.indexOf("[]")===e.length-2&&(e=e.substring(0,e.length-2)),"cf7msm_prev_urls"==e&&t.find(".wpcf7-back, .wpcf7-previous").click(function(e){window.location.href=s[f.val()],e.preventDefault()}),(0!=e.indexOf("_")||0==e.indexOf("_wpcf7_radio_free_text_")||0==e.indexOf("_wpcf7_checkbox_free_text_"))&&"cf7msm-step"!=e){var c=t.find('*[name="'+e+'"]:not([data-cf7msm-previous])'),n=t.find('input[name="'+e+'[]"]:not([data-cf7msm-previous])');if(c.length>0)"radio"==c.prop("type")||"checkbox"==c.prop("type")?c.filter(function(){return $(this).val()==s}).prop("checked",!0):c.val(s);else if(-1!==e.indexOf("-free-text")&&e.indexOf("-free-text")==e.length-"-free-text".length){var r=e.replace("-free-text",""),m=t.find('input[name="'+r+'"]:not([data-cf7msm-previous])');if(m.length>0&&""!=s){var i=m.prop("type"),a=t.find('input[name="_wpcf7_'+i+"_free_text_"+r+'"]');a.val(s),a.prop("disabled",!1)}}else n.length>0&&s.constructor===Array?""!=s&&s.length>0&&$.each(s,function(e,s){n.filter(function(){return $(this).val()==s}).prop("checked",!0)}):0!==e.indexOf("cf7msm")&&cf7msm_hasSS()&&f.after($('<input type="hidden" data-cf7msm-previous="1" name="'+e+'" value="'+quoteattr(s)+'">'));var p=t.find("#cf7msm_"+e);if(p.length>0)p.text(s);else if(-1!==e.indexOf("-free-text")&&e.indexOf("-free-text")==e.length-"-free-text".length){var r=e.replace("-free-text",""),_=t.find("#cf7msm_"+r);if(_.length>0){var o=$('<span class="cf7msm-ro-free-text"/>');o.text(s),_.append('<span class="cf7msm-ro-other-delimiter">:</span> ').append(o)}}}})}if("undefined"!=typeof cf7msm_wpcf7cf&&1==cf7msm_wpcf7cf.length&&"undefined"!=typeof wpcf7&&null!==wpcf7){var r=wpcf7.initForm;wpcf7.initForm=function(s){$(s).submit(function(f){e(s)}),r(s)}}document.addEventListener("wpcf7mailsent",function(e){if(cf7msm_hasSS()){var s=0,f=0,t=[],c={};if(cf7msm_ss=sessionStorage.getObject("cf7msm"),cf7msm_ss||(cf7msm_ss={}),$.each(e.detail.inputs,function(n){var r=e.detail.inputs[n].name,m=e.detail.inputs[n].value;if(r.indexOf("[]")===r.length-2?(-1===$.inArray(r,t)&&(c[r]=[]),c[r].push(m)):c[r]=m,"cf7msm-step"===r){if(-1!==m.indexOf("-")){var i={};cf7msm_ss&&cf7msm_ss.cf7msm_prev_urls&&(i=cf7msm_ss.cf7msm_prev_urls);var a=m.split("-");if(s=parseInt(a[0]),f=parseInt(a[1]),nextUrl=a[2],s<f){var p=1+parseInt(s)+"-"+f;i[p]=window.location.href,$("#"+e.detail.unitTag).find("div.wpcf7-mail-sent-ok").remove()}else s===f&&$("#"+e.detail.unitTag+" form").children().not("div.wpcf7-response-output").hide();cf7msm_ss.cf7msm_prev_urls=i}}else t.push(r)}),0!=s){if(void 0===cf7msm_ss["cf7msm-step-names"]&&(cf7msm_ss["cf7msm-step-names"]={}),void 0!==cf7msm_ss["cf7msm-step-names"]["step-"+s+"-names"]){var n=cf7msm_ss["cf7msm-step-names"]["step-"+s+"-names"];$.each(n,function(e){var s=n[e];delete cf7msm_ss[s]}),t=cf7msm_uniqueArray(cf7msm_ss["cf7msm-step-names"]["step-"+s+"-names"],t)}cf7msm_ss["cf7msm-step-names"]["step-"+s+"-names"]=t,$.each(c,function(e,s){cf7msm_ss[e]=s})}0!=s&&s===f&&(cf7msm_ss={}),sessionStorage.setObject("cf7msm",cf7msm_ss)}},!1)}}),Storage.prototype.setObject=function(e,s){this.setItem(e,JSON.stringify(s))},Storage.prototype.getObject=function(e){var s=this.getItem(e);return s&&JSON.parse(s)};